<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings - Dominum</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

<style>
:root {
  --bg: #0b0a16;
  --accent: #7a5cff;
  --blue: #00bfff;
  --text: #e6e6ff;
  --surface: rgba(255,255,255,0.05);
  --border: rgba(255,255,255,0.1);
  --card-bg: rgba(255,255,255,0.03);
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);
  color:var(--text);
  font-family:'Orbitron',sans-serif;
  overflow:scroll;
  height:100vh;width:100vw;
}
#particles-js{position:fixed;width:100%;height:100%;top:0;left:0;z-index:0}
.content{
  position:relative;z-index:1;display:flex;flex-direction:column;
  align-items:center;justify-content:center;height:100vh;text-align:center;padding:0 20px;
}
h1{color:var(--accent);font-size:2.5em;margin-bottom:30px}
.setting-box{
  background:var(--surface);
  border:1px solid var(--accent);
  border-radius:20px;
  padding:20px 30px;
  width:90%;
  max-width:500px;
  margin-bottom:25px;
}
label{display:block;margin-bottom:8px;color:var(--blue)}
select,input[type="color"],input[type="text"],input[type="url"],button,input[type="file"]{
  width:100%;
  padding:10px;
  border:none;
  border-radius:8px;
  background:rgba(255,255,255,0.07);
  color:var(--text);
  font-family:'Orbitron',sans-serif;
  outline:none;
}
button{
  margin-top:10px;
  border:1px solid var(--accent);
  background:rgba(255,255,255,0.05);
  cursor:pointer;
  transition:all 0.3s ease;
}
button:hover{
  border-color:var(--blue);
  color:var(--blue);
  box-shadow:0 0 10px var(--blue);
}
</style>
</head>
<body>

<div id="particles-js"></div>
<div class="content">
  <h1>Settings</h1>

  <div class="setting-box">
    <label for="theme">Theme Preset</label>
    <select id="theme">
      <option value="default">Default</option>
      <option value="cyber">Cyber</option>
      <option value="sunset">Sunset</option>
      <option value="neon">Neon</option>
      <option value="darkred">Dark Red</option>
      <option value="dnv2">DNV2</option>
      <option value="custom">Custom</option>
    </select>
    <div id="custom-theme-inputs" style="display:none;margin-top:10px;">
      <label>Background</label><input type="color" id="bgColor">
      <label>Accent</label><input type="color" id="accentColor">
      <label>Blue</label><input type="color" id="blueColor">
      <label>Text</label><input type="color" id="textColor">
      <button id="saveCustom">Save Custom Theme</button>
    </div>
  </div>

  <div class="setting-box">
    <label>Tab Cloak</label>
    <select id="tabCloakPreset">
      <option value="none">None</option>
      <option value="google">Google</option>
      <option value="drive">Google Drive</option>
      <option value="docs">Google Docs</option>
      <option value="slides">Google Slides</option>
      <option value="classroom">Google Classroom</option>
      <option value="custom">Custom</option>
    </select>

    <div id="customCloakInputs" style="display:none;margin-top:10px;">
      <label>Custom Tab Title</label>
      <input type="text" id="customTitle" placeholder="Enter tab title">
      <label>Tab Icon</label>
      <input type="file" id="customIconUpload" accept="image/*">
      <label>or Image URL</label>
      <input type="url" id="customIconURL" placeholder="https://example.com/favicon.png">
    </div>
    <button id="saveCloak">Save Tab Cloak</button>
  </div>

  <div class="setting-box">
    <label>about:blank Mode</label>
    <button id="openAboutBlank">Open Site in about:blank</button>
  </div>

  <div class="setting-box">
    <label>Panic Button Key</label>
    <input type="text" id="panicKey" placeholder="Press a key..." maxlength="1">
    <label>Panic Button Redirect URL</label>
    <input type="url" id="panicLink" placeholder="https://example.com">
    <button id="savePanic">Save Panic Settings</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script>
function setCookie(name, value, days=365){
  const d = new Date();
  d.setTime(d.getTime() + (days*24*60*60*1000));
  document.cookie = `${name}=${encodeURIComponent(value)};expires=${d.toUTCString()};path=/`;
}
function getCookie(name){
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? decodeURIComponent(match[2]) : null;
}

particlesJS("particles-js", {
  "particles":{"number":{"value":60},"color":{"value":["#7a5cff","#00bfff"]},
  "shape":{"type":"circle"},"opacity":{"value":0.5},"size":{"value":2},
  "line_linked":{"enable":true,"distance":130,"color":"#7a5cff","opacity":0.2,"width":1},
  "move":{"enable":true,"speed":1.2,"direction":"none","out_mode":"out"}},
  "interactivity":{"events":{"onhover":{"enable":true,"mode":"repulse"}},
  "modes":{"repulse":{"distance":100}}},"retina_detect":true
});

const root=document.documentElement;
const themes={
  default:{"--bg":"#0b0a16","--accent":"#7a5cff","--blue":"#00bfff","--text":"#e6e6ff"},
  cyber:{"--bg":"#050c1b","--accent":"#39ff14","--blue":"#00ffff","--text":"#e0ffe0"},
  sunset:{"--bg":"#1a0b0b","--accent":"#ff6f61","--blue":"#ffa500","--text":"#fff0e6"},
  neon:{"--bg":"#0f0020","--accent":"#ff00ff","--blue":"#00ffff","--text":"#ffffff"},
  darkred:{"--bg":"#1b0000","--accent":"#ff0000","--blue":"#cc0000","--text":"#ffe6e6"},
  dnv2:{"--bg":"#050007","--accent":"#ff00de","--blue":"#00fff7","--text":"#ffffff"}
};
function applyTheme(theme){ Object.entries(theme).forEach(([v,k])=>root.style.setProperty(v,k)); }
function saveTheme(name,custom){
  setCookie("dominum-theme",name);
  if(custom) setCookie("dominum-custom-theme",JSON.stringify(custom));
}
function loadTheme(){
  const name=getCookie("dominum-theme")||"default";
  if(name==="custom"){
    const t=JSON.parse(getCookie("dominum-custom-theme")||"{}");
    applyTheme(t);
  } else applyTheme(themes[name]);
  document.getElementById("theme").value=name;
}
document.getElementById("theme").onchange=e=>{
  if(e.target.value==="custom"){
    document.getElementById("custom-theme-inputs").style.display="block";
  }else{
    document.getElementById("custom-theme-inputs").style.display="none";
    applyTheme(themes[e.target.value]);
    saveTheme(e.target.value);
  }
};
document.getElementById("saveCustom").onclick=()=>{
  const custom={
    "--bg":bgColor.value,"--accent":accentColor.value,"--blue":blueColor.value,"--text":textColor.value
  };
  applyTheme(custom);
  saveTheme("custom",custom);
};

document.getElementById("openAboutBlank").onclick=()=>{
  const win=window.open("about:blank","_blank");
  const iframe=win.document.createElement("iframe");
  iframe.src="/index.html";
  iframe.style="border:none;width:100%;height:100vh;";
  win.document.body.style.margin="0";
  win.document.body.appendChild(iframe);
};

const panicKeyInput = document.getElementById("panicKey");
const panicLinkInput = document.getElementById("panicLink");

if (!getCookie("dominum-panic-key")) setCookie("dominum-panic-key","`");
if (!getCookie("dominum-panic-link")) setCookie("dominum-panic-link","https://google.com/");

panicKeyInput.value = getCookie("dominum-panic-key");
panicLinkInput.value = getCookie("dominum-panic-link");

document.getElementById("savePanic").onclick = () => {
  setCookie("dominum-panic-key", panicKeyInput.value.toLowerCase());
  setCookie("dominum-panic-link", panicLinkInput.value);
  alert("Panic settings saved!");
};

document.addEventListener("keydown", e=>{
  const key = getCookie("dominum-panic-key") || "`";
  const link = getCookie("dominum-panic-link") || "https://google.com/";
  if(e.key.toLowerCase() === key.toLowerCase()){
    window.location.href = link;
  }
});

const cloakPresets = {
  google: { title: "Google", icon: "https://www.google.com/favicon.ico" },
  drive: { title: "My Drive - Google Drive", icon: "https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png" },
  docs: { title: "Google Docs", icon: "https://ssl.gstatic.com/docs/doclist/images/mediatype/icon_1_document_x16.png" },
  slides: { title: "Google Slides", icon: "https://ssl.gstatic.com/docs/doclist/images/mediatype/icon_1_presentation_x16.png" },
  classroom: { title: "Google Classroom", icon: "https://ssl.gstatic.com/classroom/favicon.png" }
};

const presetSelect = document.getElementById("tabCloakPreset");
const customCloakInputs = document.getElementById("customCloakInputs");

presetSelect.onchange = () => {
  customCloakInputs.style.display = presetSelect.value === "custom" ? "block" : "none";
};

function applyCloak(title, iconURL){
  document.title = title;
  let link = document.querySelector("link[rel='icon']") || document.createElement("link");
  link.rel = "icon";
  link.href = iconURL;
  document.head.appendChild(link);
}

document.getElementById("saveCloak").onclick = () => {
  const choice = presetSelect.value;
  if(choice === "custom"){
    const title = document.getElementById("customTitle").value || "New Tab";
    const file = document.getElementById("customIconUpload").files[0];
    const url = document.getElementById("customIconURL").value;
    if(file){
      const reader = new FileReader();
      reader.onload = () => {
        setCookie("dominum-cloak", JSON.stringify({title, icon: reader.result}));
        applyCloak(title, reader.result);
      };
      reader.readAsDataURL(file);
    } else if(url){
      setCookie("dominum-cloak", JSON.stringify({title, icon: url}));
      applyCloak(title, url);
    }
  } else if(choice !== "none"){
    const c = cloakPresets[choice];
    setCookie("dominum-cloak", JSON.stringify(c));
    applyCloak(c.title, c.icon);
  } else {
    setCookie("dominum-cloak", "");
    applyCloak("Dominum", "");
  }
  alert("Tab cloak saved!");
};

(function(){
  const cloakData = getCookie("dominum-cloak");
  if(cloakData){
    try {
      const {title, icon} = JSON.parse(cloakData);
      applyCloak(title, icon);
    }catch(e){}
  }
})();

loadTheme();
</script>
</body>
</html>