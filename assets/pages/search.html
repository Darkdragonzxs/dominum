<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dominum Browser</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<style>
  :root {
    --bg: #0d0d10;
    --tab-bg: #18181c;
    --accent: #7a5cff;
    --text: #e6e6ff;
  }

  body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: var(--text);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  /* Tabs Bar */
  .tabs {
    position: relative;
    display: flex;
    align-items: center;
    height: 36px;
    background: var(--tab-bg);
    border-bottom: 1px solid #1f1f25;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .tab {
    background: #1f1f25;
    padding: 4px 12px;
    border-radius: 6px 6px 0 0;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    flex-shrink: 1;
    animation: tabIn 0.3s ease forwards;
  }

  .tab.active {
    background: #2b2b35;
  }

  .tab:hover {
    background: #25252f;
  }

  .tab span {
    font-size: 0.85em;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 120px;
  }

  .tab.removing {
    animation: tabOut 0.25s ease forwards;
  }

  .tab-controls {
    margin-left: auto;
    display: flex;
    align-items: center;
    position: absolute;
    right: 0;
    height: 100%;
    background: var(--tab-bg);
    padding-right: 6px;
  }

  .tab-controls i {
    color: var(--accent);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: transform 0.2s ease, background 0.2s ease;
  }

  .tab-controls i:hover {
    background: #24242d;
    transform: scale(1.2);
  }

  @keyframes tabIn {
    from { opacity: 0; transform: scale(0.85); }
    to { opacity: 1; transform: scale(1); }
  }

  @keyframes tabOut {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0; transform: scale(0.7); }
  }

  .toolbar {
    height: 44px;
    display: flex;
    align-items: center;
    background: var(--bg);
    padding: 0 10px;
    gap: 8px;
    border-bottom: 1px solid #1f1f25;
  }

  .toolbar button {
    background: none;
    border: none;
    color: var(--text);
    cursor: pointer;
    font-size: 1.05em;
    transition: transform 0.2s ease, color 0.2s ease;
  }

  .toolbar button:hover {
    transform: scale(1.2);
    color: var(--accent);
  }

  .omnibox {
    flex: 1;
    background: #1b1b22;
    border: 1px solid #2b2b35;
    border-radius: 20px;
    padding: 8px 14px;
    color: var(--text);
    font-size: 0.9em;
    outline: none;
    transition: all 0.3s ease;
  }

  .omnibox:focus {
    border-color: var(--accent);
    box-shadow: 0 0 8px var(--accent);
  }

  iframe {
    flex: 1;
    border: none;
    width: 100%;
    height: 100%;
    background: #000;
    transition: opacity 0.4s ease;
    opacity: 0;
  }

  iframe.loaded {
    opacity: 1;
  }
</style>
</head>
<body>

<div class="tabs" id="tabs">
  <div class="tab active"><i class="fa-solid fa-globe"></i><span>New Tab</span></div>
  <div class="tab-controls">
    <i class="fa-solid fa-plus" id="newTab"></i>
    <i class="fa-solid fa-xmark" id="closeTab"></i>
  </div>
</div>

<div class="toolbar">
  <button id="back"><i class="fa-solid fa-arrow-left"></i></button>
  <button id="forward"><i class="fa-solid fa-arrow-right"></i></button>
  <button id="reload"><i class="fa-solid fa-rotate-right"></i></button>
  <input class="omnibox" id="omnibox" type="text" placeholder="Search or enter URL">
</div>

<iframe id="viewer" src="/assets/pages/prx/home.html"></iframe>

<script>
const iframe = document.getElementById('viewer');
const omnibox = document.getElementById('omnibox');
const reloadBtn = document.getElementById('reload');
const tabsContainer = document.getElementById('tabs');
const newTabBtn = document.getElementById('newTab');
const closeTabBtn = document.getElementById('closeTab');

function updateTabWidths() {
  const tabs = [...document.querySelectorAll('.tab')];
  const totalWidth = tabsContainer.offsetWidth - 90;
  const count = tabs.length;
  const tabWidth = Math.max(80, Math.min(240, totalWidth / count));
  tabs.forEach(tab => tab.style.flex = `0 1 ${tabWidth}px`);
}

function loadURL(input) {
  let url = input.trim();
  if (!url) return;
  if (!url.startsWith('http') && !url.includes('.')) {
    url = `https://search.brave.com/search?q=${encodeURIComponent(input)}`;
  } else if (!url.startsWith('http')) {
    url = 'https://' + url;
  }
  iframe.classList.remove('loaded');
  iframe.src = `/s/embed.html#${url}`;
}

omnibox.addEventListener('keydown', e => {
  if (e.key === 'Enter') loadURL(omnibox.value);
});

iframe.addEventListener('load', () => iframe.classList.add('loaded'));
reloadBtn.addEventListener('click', () => iframe.contentWindow.location.reload());

newTabBtn.addEventListener('click', () => {
  const tabCount = document.querySelectorAll('.tab').length;
  if (tabCount >= 10) return;

  const tab = document.createElement('div');
  tab.className = 'tab';
  tab.innerHTML = `<i class="fa-solid fa-globe"></i><span>New Tab</span>`;
  tabsContainer.insertBefore(tab, document.querySelector('.tab-controls'));
  activateTab(tab);
  updateTabWidths();
});

tabsContainer.addEventListener('click', e => {
  const tab = e.target.closest('.tab');
  if (tab && !tab.classList.contains('active')) {
    activateTab(tab);
  }
});

closeTabBtn.addEventListener('click', () => {
  const active = document.querySelector('.tab.active');
  if (!active) return;
  active.classList.add('removing');
  setTimeout(() => {
    active.remove();
    const remaining = document.querySelectorAll('.tab');
    if (!remaining.length) newTabBtn.click();
    else remaining[remaining.length - 1].classList.add('active');
    updateTabWidths();
  }, 200);
});

function activateTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  tab.classList.add('active');
  iframe.src = '/assets/pages/prx/home.html';
  omnibox.value = '';
}

window.addEventListener('resize', updateTabWidths);
updateTabWidths();
</script>
<script>
  const root=document.documentElement;
  const name=localStorage.getItem("dominum-theme")||"default";
  const themes={
    default:{"--bg":"#0b0a16","--accent":"#7a5cff","--blue":"#00bfff","--text":"#e6e6ff"},
    cyber:{"--bg":"#050c1b","--accent":"#39ff14","--blue":"#00ffff","--text":"#e0ffe0"},
    sunset:{"--bg":"#1a0b0b","--accent":"#ff6f61","--blue":"#ffa500","--text":"#fff0e6"},
    neon:{"--bg":"#0f0020","--accent":"#ff00ff","--blue":"#00ffff","--text":"#ffffff"},
    darkred:{"--bg":"#1b0000","--accent":"#ff0000","--blue":"#cc0000","--text":"#ffe6e6"}
  };
  if(name==="custom"){
    const t=JSON.parse(localStorage.getItem("dominum-custom-theme")||"{}");
    Object.entries(t).forEach(([v,k])=>root.style.setProperty(v,k));
  }else Object.entries(themes[name]).forEach(([v,k])=>root.style.setProperty(v,k));
  document.addEventListener("keydown",e=>{
    const key=localStorage.getItem("dominum-panic-key");
    const link=localStorage.getItem("dominum-panic-link");
    if(key&&link&&e.key.toLowerCase()===key)window.location.href=link;
  });
</script>
</body>
</html>
